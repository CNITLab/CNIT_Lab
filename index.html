<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CNIT Lab | ISTA</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    .content {
      padding-bottom: 350px;
    }
    .navbar, .navbar h1, .navbar nav a {
      color: #ffffef !important;
    }

    .dropdown-menu {
      position: absolute;
      top: 100%;
      right: 0;
      left: auto;
      background: #1e293b;
      border-radius: 0 0 12px 12px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.12);
      padding: 1em 1.5em;
      z-index: 100;
      min-width: 180px;
      max-width: 90vw;
      flex-direction: column;
      gap: 0.5em;
      overflow-x: auto;
      opacity: 0;
      transform: translateY(-20px) scale(0.98);
      pointer-events: none;
      transition: opacity 0.4s cubic-bezier(.5,1.5,.5,1), transform 0.4s cubic-bezier(.5,1.5,.5,1);
    }
    .dropdown-menu.show {
      opacity: 1;
      transform: translateY(0) scale(1);
      pointer-events: auto;
      transition: opacity 0.4s cubic-bezier(.5,1.5,.5,1), transform 0.4s cubic-bezier(.5,1.5,.5,1);
    }
    .menu-toggle[aria-expanded="true"] .hamburger-line {
      background: #1e40af;
    }
    body.fade-out {
      opacity: 0;
      transform: scale(0.98);
      filter: blur(2px);
      transition: opacity 0.8s cubic-bezier(.7,.2,.3,1), transform 0.8s cubic-bezier(.7,.2,.3,1), filter 0.8s cubic-bezier(.7,.2,.3,1);
    }
    body.fade-in {
      opacity: 1;
      transform: scale(1);
      filter: blur(0px);
      transition: opacity 0.8s cubic-bezier(.7,.2,.3,1), transform 0.8s cubic-bezier(.7,.2,.3,1), filter 0.8s cubic-bezier(.7,.2,.3,1);
    }
    html, body {
      height: 100%;
      min-height: 100vh;
      width: 100vw;
      overflow-x: hidden;
    }
    body {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
    .scroll-container {
      flex: 1 1 auto;
      display: flex;
      flex-direction: column;
      min-height: 0;
      position: relative;
      width: 100%;
      overflow: visible;
      z-index: 0;
    }
  </style>
  <style>
    .hero-index {
      text-align: center;
      margin-top: 4.5rem;
      margin-bottom: 2.5rem;
      animation: heroFadeIn 1.2s cubic-bezier(.5,1.5,.5,1) both;
      position: relative;
      z-index: 2;
    }
    @keyframes heroFadeIn {
      from { opacity: 0; transform: translateY(-40px) scale(0.98); }
      to { opacity: 1; transform: translateY(0) scale(1); }
    }
    .hero-index h1 {
      font-size: 5rem !important;
      color: #ffffef;
      letter-spacing: 0.01em;
      text-shadow: 0 2px 12px #4eeaaf, 0 2px 12px #000;
      animation: textPop 1.2s cubic-bezier(.5,1.5,.5,1) 0.2s both;
    }
    @media (max-width: 900px) {
      .hero-index h1 {
        font-size: 4rem !important;
      }
    }
    @media (max-width: 600px) {
      .hero-index h1 {
        font-size: 3rem !important;
  }
    }
    .hero-index p {
      font-size: 0.9rem;
      color: #ffffef;
      margin-top: 0.7em;
      opacity: 0.95;
      text-shadow: 0 2px 8px #4eeaaf, 0 1px 4px #000;
      animation: textPop 1.2s cubic-bezier(.5,1.5,.5,1) 0.4s both;
    }
    @keyframes textPop {
      from { opacity: 0; transform: scale(0.95); }
      to { opacity: 1; transform: scale(1); }
    }
    .floating-molecule-index {
      position: absolute;
      z-index: 1;
      opacity: 0.13;
      pointer-events: none;
      animation: floatmolindex 8s ease-in-out infinite alternate;
    }
    .floating-molecule-index.mol1 {
      top: 2vw; left: 4vw; width: 90px; animation-delay: 0s;
    }
    .floating-molecule-index.mol2 {
      top: 12vw; right: 6vw; width: 70px; animation-delay: 2s;
    }
    .floating-molecule-index.mol3 {
      bottom: 8vw; left: 10vw; width: 60px; animation-delay: 1.5s;
    }
    @keyframes floatmolindex {
      0% { transform: translateY(0) rotate(0deg); }
      100% { transform: translateY(18px) rotate(8deg); }
    }
    .welcome-block {
      animation: fadeInUp 1.2s 0.7s both;
      position: relative;
      z-index: 2;
    }
    body.fade-out {
      opacity: 0;
      transition: opacity 0.5s cubic-bezier(.5,1.5,.5,1);
    }
    body.fade-in {
      opacity: 1;
      transition: opacity 1.6s cubic-bezier(.5,1.5,.5,1);
    }
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(40px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .carousel-section {
      animation: fadeInUp 1.2s 1.1s both;
      position: relative;
      z-index: 2;
    }
    .carousel-cards-container {
      position: relative;
      max-width: 1600px;
      width: 100%;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    .carousel-side-cartoon {
      position: absolute;
      left: -120px;
      top: 50%;
      transform: translateY(20%);
      width: 400px;
      height: auto;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.7s cubic-bezier(.5,1.5,.5,1);
      z-index: 3;
    }
    .carousel-side-cartoon.show {
      opacity: 1;
    }
    .carousel-side-cartoon-right {
      position: absolute;
      right: -80px;
      top: 50%;
      transform: translateY(25%);
      width: 550px;
      height: auto;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.7s cubic-bezier(.5,1.5,.5,1);
      z-index: 3;
    }
    .carousel-side-cartoon-right.show {
      opacity: 1;
    }
    @media (max-width: 1800px) {
      .carousel-side-cartoon,
      .carousel-side-cartoon-right {
        display: none;
      }
    }
    .carousel-card {
      background: #111;
      color: #ffffef;
      border-radius: 28px;
      box-shadow: 0 4px 32px #1b7c4b33, 0 2px 12px #000a;
      border-left: 8px solid #1b7c4b;
      border-right: 2px solid #1b7c4b;
      padding: 0.9em 0; /* reduced further from 1.6em */
      margin: 0 auto;
      max-width: 1430px;
      width: 100%;
      position: absolute;
      left: 0;
      right: 0;
      top: 0;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.7s cubic-bezier(.5,1.5,.5,1);
      z-index: 1;
      height: auto;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    .carousel-card.active {
      opacity: 1;
      pointer-events: auto;
      z-index: 2;
    }
    .carousel-cards-container {
      min-height: 0;
    }
    .carousel-text {
      position: relative;
      width: 100%;
      color: #ffffef;
      padding: 0;
      max-width: 100%;
      margin: 0 auto;
      z-index: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    .carousel-dots {
      z-index: 10 !important;
      position: relative;
    }
    .carousel-dot {
      width: 12px; height: 12px; border-radius: 50%; background: #e6f4ea; border: 2px solid #1b7c4b; margin: 0 4px; display: inline-block; transition: background 0.3s, border 0.3s;
    }
    .carousel-dot.active {
      background: #1b7c4b;
      border: 2px solid #e6f4ea;
    }
    .menu-toggle {
      transition: transform 0.3s cubic-bezier(.5,1.5,.5,1);
    }
    .menu-toggle:active {
      transform: scale(1.1) rotate(8deg);
    }
    .dropdown-menu a {
      color: #ffffef !important;
    }
    /* Removed duplicate dropdown-menu rules above. JS for fade-in/out remains below. */
    /* Background video container styling */
    .background, .background-static {
      position: fixed;
      left: 50%;
      top: 50%;
      width: 100vw;
      height: 100vh;
      z-index: -2;
      transform: translate(-50%, -50%);
      pointer-events: none;
    }
    .background video {
      width: 100%;
      height: 100%;
      object-fit: cover;
      object-position: center center;
      -webkit-object-fit: cover;
    }
    .scroll-container {
      -webkit-overflow-scrolling: touch;
    }
    @media (max-width: 768px) {
      .background,
      .background-static {
        width: 100vw !important;
        height: 100vh !important;
        height: calc(var(--vh, 1vh) * 100) !important;
        transform: translate(-50%, -50%) !important;
      }
    }
    @supports (-webkit-touch-callout: none) {
      .background video {
        -webkit-transform: translateZ(0);
        transform: translateZ(0);
      }
    }
  </style>
  <script>
    // Mobile viewport height fix
    function setViewportHeight() {
      const vh = window.innerHeight * 0.01;
      document.documentElement.style.setProperty('--vh', `${vh}px`);
    }
    setViewportHeight();
    window.addEventListener('resize', setViewportHeight);
    window.addEventListener('orientationchange', setViewportHeight);

    // Video fallback for mobile
    document.addEventListener('DOMContentLoaded', function() {
      const video = document.querySelector('.background video');
      const videoContainer = document.querySelector('.background');
      const staticBg = document.querySelector('.background-static');
      
      if (video) {
        const playPromise = video.play();
        
        if (playPromise !== undefined) {
          playPromise.catch(error => {
            console.log('Video autoplay prevented, using static background');
            // Copy transform from video container to static background
            if (videoContainer && staticBg) {
              staticBg.style.transform = videoContainer.style.transform;
              staticBg.style.width = videoContainer.style.width;
              staticBg.style.height = videoContainer.style.height;
            }
            if (videoContainer) videoContainer.style.display = 'none';
            if (staticBg) staticBg.style.display = 'block';
          });
        }
        
        // When video ends, switch to static background
        video.addEventListener('ended', function() {
          console.log('Video ended, switching to static background');
          // Copy transform from video container to static background
          if (videoContainer && staticBg) {
            staticBg.style.transform = videoContainer.style.transform;
            staticBg.style.width = videoContainer.style.width;
            staticBg.style.height = videoContainer.style.height;
          }
          if (videoContainer) videoContainer.style.display = 'none';
          if (staticBg) staticBg.style.display = 'block';
        });
        
        video.addEventListener('error', function() {
          console.log('Video error, using static background');
          // Copy transform from video container to static background
          if (videoContainer && staticBg) {
            staticBg.style.transform = videoContainer.style.transform;
            staticBg.style.width = videoContainer.style.width;
            staticBg.style.height = videoContainer.style.height;
          }
          if (videoContainer) videoContainer.style.display = 'none';
          if (staticBg) staticBg.style.display = 'block';
        });
      }
    });
  </script>
</head>
<body class="index-page">
  <div class="background">
    <video autoplay muted playsinline preload="auto">
      <source src="images/welcome_background.mp4" type="video/mp4">
      <!-- Fallback for browsers that don't support video -->
      Your browser does not support the video tag.
    </video>
  </div>
  <div class="background-static" style="display:none; position: fixed; left: 50%; top: 50%; width: 142vw; height: 142vh; z-index: -2; background: url('images/static_background.png') center center/cover no-repeat; transform: translate(-50%, -50%); pointer-events: none;"></div>
  <!-- .background-static removed: no longer needed -->
  <img class="floating-molecule-index mol2" src="images/Mock_cartoon_1.png" alt="Cartoon 1" />
  <div class="menu-container floating-menu">
    <button class="menu-toggle" onclick="toggleMenu()">
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
    </button>
    <nav class="dropdown-menu">
      <a href="index.html">Home</a>
      <a href="research.html">Research</a>
      <a href="group.html">People</a>
      <a href="publications.html">Publications</a>
      <a href="news.html">News</a>
      <a href="culture.html">Culture</a>
      <a href="positions.html">Open Positions</a>
    </nav>
  </div>

  <div class="scroll-container">
    <div class="hero-index">
      <h1>Chemistry with Intent: Adaptive Responses from Molecule to Material</h1>
    </div>
    <div class="content">
      <main style="flex: 1 1 auto; display: flex; flex-direction: column; min-height: 0;">
        <div class="welcome-block">
          <div style="background: #111; border-radius: 28px; box-shadow: 0 4px 32px #1b7c4b33, 0 2px 12px #000a; border-left: 8px solid #1b7c4b; border-right: 2px solid #1b7c4b; padding: 2.5em 2vw 2.5em 2vw; max-width: 1200px; width: 100%; margin: 2em auto; color: #ffffef; position: relative; z-index: 3; text-align: center; font-family: 'Segoe UI', 'Arial', sans-serif; letter-spacing: 0.01em; text-shadow: 0 2px 12px #1b7c4b, 0 2px 12px #000; font-weight: 600;">
            <h2 style="color: #4eeaaf; margin-bottom: 0.7em; font-size: 3rem;">CNIT Lab<br>Knitting Molecular Function Across Scales</h2>
            <p style="color: #ffffef; font-size: 1.4rem; margin-top: 0;">Our research at the Chemistry-driven Non-orthogonal Interactions in Tunable Materials (CNIT) Lab at ISTA bridges organic chemistry and materials science to engineer responsive systems that exhibit purposeful behavior taking molecular functions to macroscopic scales. Our goal is to “knit” chemistry, molecular assembly, materials geometry, and stimuli-responses together into adaptive systems.</p>
          </div>
        </div>
        <section class="carousel-section">
          <div class="carousel-cards-container">
            <img src="images/Cartoon_Switches.png" alt="Cartoon Switches" class="carousel-side-cartoon" id="sideCartoon" />
            <img src="images/cartoon_emergence.png" alt="Cartoon Emergence" class="carousel-side-cartoon-right" id="sideCartoonRight" />
            <!-- Card 1: Structure to Mechanistic Insight -->
            <div class="carousel-card active card1">
              <div class="carousel-text" style="position: relative; overflow: visible;">
                <h3 class="carousel-heading">From Structure to Mechanistic Insight</h3>
                <div class="carousel-media">
                  <img src="images/sec1.jpg" data-src="images/sec1_gif.gif" alt="Section 1 Animation" class="carousel-img single-media carousel-media-item delayed-gif" />
                </div>
                <p class="carousel-textbox">Through the tools of physical organic and synthetic chemistry, we uncover the mechanistic underpinnings of stimuli-responsive molecular systems. Visible light-responsive molecules are especially compelling for their non-invasive activation and their suitability for biologically and technologically relevant environments.</p>
                <!-- Card1 cartoon removed per request -->
              </div>
            </div>

            <!-- Card 2: Molecules to Functional Matter (use right element as central image) -->
            <div class="carousel-card card2">
              <div class="carousel-text" style="position: relative; overflow: visible;">
                <h3 class="carousel-heading">From Molecules to Functional Matter</h3>
                <div class="carousel-media">
                  <img src="images/sec2_gif2.gif" alt="Section 2 Animation" class="carousel-img single-media carousel-media-item" />
                </div>
                <p class="carousel-textbox">We translate molecular responsiveness into material performance by guiding how molecules organize, interact, and transform. Through this bottom-up design, emergent properties such as phase change and mechanical adaptation become accessible and tunable.</p>
                <!-- Left GIF removed per request -->
              </div>
            </div>

            <!-- Card 3: Functional Matter to Emergence (center video, delete cartoon) -->
            <div class="carousel-card card3">
              <div class="carousel-text" style="position: relative; overflow: visible; width: 100%;">
                <h3 class="card3-title carousel-heading">From Functional Matter to Emergence</h3>
                <div class="carousel-media">
                  <video src="images/vid5.mp4" autoplay loop muted playsinline class="carousel-img single-media carousel-media-item"></video>
                </div>
                <p class="carousel-textbox card3-textbox">By orchestrating structure and responsiveness across scales, we enable materials to exhibit higher-order functions—such as memory, adaptation, and selective response—rooted in their physical architecture.</p>
                <!-- Card3 cartoon removed per request -->
              </div>
            </div>

            <!-- Card 4: New Voices to New Directions (already good) -->
            <div class="carousel-card">
              <div class="carousel-text">
                <div style="margin: 0 auto; display: flex; flex-direction: column; align-items: center; justify-content: center; max-width: 900px; width: 100%;">
                  <h3 style="margin-bottom: 0.7em; text-align: center; width: 100%; font-size: 3rem; color: #4eeaaf; font-family: 'Segoe UI', 'Arial', sans-serif; letter-spacing: 0.01em; text-shadow: 0 2px 12px #1b7c4b, 0 2px 12px #000; font-weight: 600;">From New Voices to New Directions</h3>
                  <div style="width: 100%; max-width: 430px; display: flex; justify-content: center; margin-bottom: 1em;">
                    <img src="images/Sec5.png" alt="Section 5 Cartoon" style="max-width: 430px; width: 100%; height: auto; background: none; border-radius: 0; box-shadow: none; display: block; margin: 0 auto;" />
                  </div>
                  <p style="text-align: center; width: 100%; max-width: 1200px;">
                    From molecules to materials to function—if that arc excites you, we want to  <a href="mailto:friedrich.stricker@ist.ac.at">hear from you</a>!
                  </p>
                </div>
              </div>
            </div>
          </div>
        <div class="carousel-dots" style="display: flex; justify-content: center; gap: 0.7em; margin-top: -0.8em; margin-bottom: -5em; z-index: 100; position: relative;"></div>
        <div style="height: 200px;"></div>
        </div>
        </section>

      </main>
    </div>
    
  </div>
  <footer>
    <p>© 2025 CNIT Lab | Institute of Science and Technology Austria</p>
  </footer>
  <script>
    function toggleMenu() {
      const dropdownMenu = document.querySelector('.dropdown-menu');
      const toggleBtn = document.querySelector('.menu-toggle');
      const expanded = toggleBtn.getAttribute('aria-expanded') === 'true';
      if (!expanded) {
        dropdownMenu.classList.add('show');
        toggleBtn.setAttribute('aria-expanded', 'true');
      } else {
        dropdownMenu.classList.remove('show');
        toggleBtn.setAttribute('aria-expanded', 'false');
      }
    }

    // Only close the dropdown if clicked outside or on navigation
    document.addEventListener('mousedown', function(event) {
      const dropdownMenu = document.querySelector('.dropdown-menu');
      const toggleBtn = document.querySelector('.menu-toggle');
      if (dropdownMenu.classList.contains('show') && !dropdownMenu.contains(event.target) && !toggleBtn.contains(event.target)) {
        dropdownMenu.classList.remove('show');
        toggleBtn.setAttribute('aria-expanded', 'false');
      }
    });

    // Close menu on navigation
    document.querySelectorAll('.dropdown-menu a').forEach(link => {
      link.addEventListener('click', function() {
        const dropdownMenu = document.querySelector('.dropdown-menu');
        const toggleBtn = document.querySelector('.menu-toggle');
        dropdownMenu.classList.remove('show');
        toggleBtn.setAttribute('aria-expanded', 'false');
      });
    });

    document.addEventListener('DOMContentLoaded', function() {
      // Delay GIF loading until animations complete
      setTimeout(function() {
        const delayedGifs = document.querySelectorAll('.delayed-gif');
        delayedGifs.forEach(function(img) {
          if (img.hasAttribute('data-src')) {
            img.src = img.getAttribute('data-src');
          }
        });
      }, 1800); // Wait for hero and carousel animations (1.2s + 1.1s = 2.3s, but start slightly earlier)
      
      // Carousel logic (fade entire card, only one visible at a time)
      const cards = document.querySelectorAll('.carousel-card');
      const dotsContainer = document.body.querySelector('.carousel-dots');
      let current = 0;
      // Set only first card active
      cards.forEach((card, idx) => {
        if (idx === 0) {
          card.classList.add('active');
        } else {
          card.classList.remove('active');
        }
      });
      // Show side cartoon for card 1 on page load
      const sideCartoon = document.getElementById('sideCartoon');
      const sideCartoonRight = document.getElementById('sideCartoonRight');
      if (cards[0].classList.contains('card1')) {
        sideCartoon.classList.add('show');
      }
      // Hide right cartoon initially (card 1 is active by default)
      sideCartoonRight.classList.remove('show');
      cards.forEach((_, idx) => {
        const dot = document.createElement('div');
        dot.className = 'carousel-dot' + (idx === 0 ? ' active' : '');
        dot.addEventListener('click', () => {
          if (current !== idx) {
            animateCarouselOut(cards[current]);
            dotsContainer.children[current].classList.remove('active');
            current = idx;
            setTimeout(() => {
              animateCarouselIn(cards[current]);
              dotsContainer.children[current].classList.add('active');
            }, 400); // fade out before fade in
          }
        });
        dotsContainer.appendChild(dot);
      });
      function animateCarouselOut(card) {
        card.classList.remove('active');
      }
      function animateCarouselIn(card) {
        card.classList.add('active');
        // Show side cartoon only for card 1
        const sideCartoon = document.getElementById('sideCartoon');
        const sideCartoonRight = document.getElementById('sideCartoonRight');
        if (card.classList.contains('card1')) {
          sideCartoon.classList.add('show');
        } else {
          sideCartoon.classList.remove('show');
        }
        // Show right cartoon only for card 3
        if (card.classList.contains('card3')) {
          sideCartoonRight.classList.add('show');
        } else {
          sideCartoonRight.classList.remove('show');
        }
      }
      setInterval(() => {
        animateCarouselOut(cards[current]);
        dotsContainer.children[current].classList.remove('active');
        current = (current + 1) % cards.length;
        setTimeout(() => {
          animateCarouselIn(cards[current]);
          dotsContainer.children[current].classList.add('active');
        }, 400);
      }, 15000);
    });

    // Store rotation so it doesn't change on resize
    const rot = window._backgroundRotation || Math.floor(Math.random() * 360);
    window._backgroundRotation = rot;
    
    function applyBackgroundTransform() {
      const angleRad = (rot % 360) * Math.PI / 180;

      const sin = Math.abs(Math.sin(angleRad));
      const cos = Math.abs(Math.cos(angleRad));

      const vw = window.innerWidth;
      const vh = window.innerHeight;

      const bg = document.querySelector('.background');
      const bgStatic = document.querySelector('.background-static');

      // Start with base size matching viewport
      const baseW = vw;
      const baseH = vh;

      // Calculate rotated bounding box dimensions
      const bboxW = baseW * cos + baseH * sin;
      const bboxH = baseW * sin + baseH * cos;

      // Add a small margin for safety
      const paddingFactor = 1.02;

      const adjustedW = bboxW * paddingFactor;
      const adjustedH = bboxH * paddingFactor;

      // Set the background size dynamically for both video and static
      bg.style.width = `${adjustedW}px`;
      bg.style.height = `${adjustedH}px`;
      bgStatic.style.width = `${adjustedW}px`;
      bgStatic.style.height = `${adjustedH}px`;

      // Calculate the scale needed (if any)
      const scaleW = vw / bboxW;
      const scaleH = vh / bboxH;
      const scale = Math.max(scaleW, scaleH, 1);

      // Apply transform to both video and static
      const transform = `translate(-50%, -50%) rotate(${rot}deg) scale(${scale})`;
      bg.style.transform = transform;
      bgStatic.style.transform = transform;
    }
    applyBackgroundTransform();
    window.addEventListener('resize', applyBackgroundTransform);
    // Listen for zoom (via resize, orientationchange, or visualViewport)
    if (window.visualViewport) {
      window.visualViewport.addEventListener('resize', applyBackgroundTransform);
    }
  </script>
</body>
</html>